---
title: STKOF
date: 2025-12-14 17:00:00 +0000
categories: [CTF, Upsolve]
tags: [pwnable]
math: true
mermaid: true
media_subpath: /assets/posts/2025-12-14-Stkof
image:
  path: preview.png
---

## STKOF

### Overview

**STKOF** is a classic heap exploitation challenge from *HITCON CTF 2014*, targeting glibc 2.23. The binary contains a heap-based overflow vulnerability that allows corruption of adjacent chunk metadata. By abusing this corruption, we can perform the classic unsafe unlink attack, leading to arbitrary read/write.

Using this primitive, we leak the libc address and overwrite the GOT entry of *free* with *system*, ultimately achieving code execution and spawning a shell.

Challenge files are available [here](https://github.com/guyinatuxedo/nightmare/tree/master/modules/30-unlink/hitcon14_stkof).

### Program Analysis

We are provided with the executable *stkof* and the corresponding libc file *libc-2.23.so*.

Since the binary is dynamically linked and uses our system libc by default, we need to patch it to use the provided libc. This can be done using pwninit:

```bash
pwninit --bin stkof --libc libc-2.23.so --no-template
```

Checking the file type and protections we get this:

```bash
~/Desktop/BinExp/Challs/HEAP/Stkof ❯ file stkof
stkof: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=4872b087443d1e52ce720d0a4007b1920f18e7b0, stripped
                                                                                                                                                                                             
~/Desktop/BinExp/Challs/HEAP/Stkof ❯ checksec stkof
[*] '/home/mark/Desktop/BinExp/Challs/HEAP/Stkof/stkof'
    Arch:       amd64-64-little
    RELRO:      Partial RELRO
    Stack:      Canary found
    NX:         NX enabled
    PIE:        No PIE (0x400000)
```

Shows that standard you'd expect except that it has *Partial RELRO* meaning the *Global Offset Table (GOT)* is writable.


